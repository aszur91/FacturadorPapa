<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>App de Facturación</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<header>
  <h1>FactuApp</h1>
</header>

<nav id="menuPrincipal">
  <button id="btnEmpresas">Empresas</button>
  <button id="btnClientes">Clientes</button>
  <button id="btnPresupuestos">Presupuestos</button>
  <button id="btnFacturas">Facturas</button>
  <button id="btnAjustes">Ajustes</button>
</nav>

<main>
  <section id="pantallaEmpresas" class="pantalla active">
    <h2>Gestión de Empresas</h2>
    
    <form id="formEmpresa" class="formulario-card">
      <h3>Datos de la Empresa</h3>
      <div class="grid-form">
        <input type="text" id="empNombre" placeholder="Nombre de empresa" required>
        <input type="text" id="empCIF" placeholder="CIF/NIF" required>
        <input type="text" id="empCalle" placeholder="Calle" required>
        <input type="text" id="empNumero" placeholder="Número" required>
        <input type="text" id="empPuerta" placeholder="Puerta/Piso/Letra" required>
        <input type="text" id="empCP" placeholder="Código Postal" required>
        <input type="text" id="empLocalidad" placeholder="Localidad" required>
        <input type="text" id="empProvincia" placeholder="Provincia" required>
        <input type="tel" id="empTelefono" placeholder="Teléfono" required>
        <input type="email" id="empEmail" placeholder="Email" required>
        <input type="text" id="empIBAN" placeholder="IBAN" required>
        <div class="upload-box">
          <label>Logotipo (opcional):</label>
          <input type="file" id="empLogo" accept="image/*">
        </div>
      </div>
      <input type="hidden" id="empEditIndex" value="-1">
      <button type="button" id="btnGuardarEmpresa" class="btn-main">Guardar Empresa</button>
    </form>
  
    <ul id="listaEmpresas"></ul>
  </section>

  <section id="pantallaClientes" class="pantalla">
    <h2>Gestión de Clientes</h2>
    
    <form id="formCliente" class="formulario-card">
      <h3>Datos del Cliente</h3>
      <div class="grid-form">
        <input type="text" id="cliNombre" placeholder="Nombre" required>
        <input type="text" id="cliApellidos" placeholder="Apellidos" required>
        <input type="text" id="cliCIF" placeholder="CIF/NIF" required>
        <input type="text" id="cliCalle" placeholder="Calle" required>
        <input type="text" id="cliNumero" placeholder="Número" required>
        <input type="text" id="cliPuerta" placeholder="Puerta/Piso/Letra" required>
        <input type="text" id="cliCP" placeholder="Código Postal" required>
        <input type="text" id="cliLocalidad" placeholder="Localidad" required>
        <input type="text" id="cliProvincia" placeholder="Provincia" required>
        <input type="tel" id="cliTelefono" placeholder="Teléfono" required>
        <input type="email" id="cliEmail" placeholder="Email" required>
      </div>
      <input type="hidden" id="cliEditIndex" value="-1">
      <button type="button" id="btnGuardarCliente" class="btn-main">Guardar Cliente</button>
    </form>
  
    <ul id="listaClientes"></ul>
  </section>
  
  <section id="pantallaPresupuestos" class="pantalla">
    <h2>Presupuestos</h2>
    <div class="selector-empresa">
      <label for="empresaActiva">Empresa emisora:</label>
      <select id="empresaActiva"></select>
    </div>
    <button id="btnAddPresupuesto" class="btn-main">Crear Nuevo Presupuesto</button>
    <ul id="listaPresupuestos"></ul>
  </section>

  <section id="pantallaFacturas" class="pantalla">
    <h2>Historial de Facturas</h2>
    <ul id="listaFacturas"></ul>
  </section>

  <section id="pantallaAjustes" class="pantalla">
    <h2>Configuración</h2>
    <div class="form-ajustes">
      <label>Color corporativo: <input type="color" id="ajusteColor"></label>
      <label>Tipo de letra: 
        <select id="ajusteTipoLetra">
          <option value="Arial">Arial</option>
          <option value="Courier">Courier</option>
          <option value="Times">Times New Roman</option>
        </select>
      </label>
      <label>Tamaño de fuente: <input type="number" id="ajusteTamano" min="10" max="24"></label>
      <label>IVA por defecto (%): <input type="number" id="ajusteIVA" min="0"></label>
      <button id="btnGuardarAjustes" class="btn-save">Guardar Cambios</button>
    </div>
  </section>

  <div id="modalPreview" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="close-modal">&times;</span>
        <h3>Borrador de Documento</h3>
      </div>
      <div id="previewContenido">
        </div>
      <div class="modal-footer">
        <button id="btnEditarPresupuesto" class="btn-edit-modal">Editar Datos</button>
        <button id="btnConfirmarPDF" class="btn-confirm-modal">Confirmar y Generar PDF</button>
      </div>
    </div>
  </div>
</main>

<script src="app.js"></script>
<script>
  // Registro del Service Worker para modo Offline
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log("PWA: Service Worker Activo"))
      .catch((err) => console.error("PWA: Error", err));
  }
</script>

</body>
</html>
