<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>FactuApp Pro</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<header>
  <h1>FactuApp Pro</h1>
</header>

<nav id="menuPrincipal">
  <button id="btnEmpresas">Empresas</button>
  <button id="btnClientes">Clientes</button>
  <button id="btnPresupuestos">Presupuestos</button>
  <button id="btnFacturas">Facturas</button>
  <button id="btnAjustes">Ajustes</button>
</nav>

<main>
  <section id="pantallaEmpresas" class="pantalla active">
    <div class="cabecera-seccion">
      <h2>Mis Empresas</h2>
      <button id="btnNuevaEmpresa" class="btn-main-short">+ Añadir</button>
    </div>
    <div id="contenedorFormEmpresa" style="display: none;">
      <form id="formempresa" class="formulario-card">
        <div class="form-header">
          <h3 id="tituloFormEmpresa">Nueva Empresa</h3>
          <button type="button" class="btn-cancelar" onclick="alternarVista('Empresa', false)">X</button>
        </div>
        <div class="grid-form">
          <input type="text" id="empNombre" placeholder="Nombre de empresa">
          <input type="text" id="empCIF" placeholder="CIF/NIF">
          <input type="text" id="empCalle" placeholder="Calle">
          <input type="text" id="empNumero" placeholder="Número">
          <input type="text" id="empPuerta" placeholder="Puerta/Piso">
          <input type="text" id="empCP" placeholder="CP">
          <input type="text" id="empLocalidad" placeholder="Localidad">
          <input type="text" id="empProvincia" placeholder="Provincia">
          <input type="text" id="empTelefono" placeholder="Teléfono">
          <input type="email" id="empEmail" placeholder="Email">
          <input type="text" id="empIBAN" placeholder="IBAN">
          <div class="upload-box">
            <label>Logo:</label>
            <input type="file" id="empLogo" accept="image/*">
          </div>
        </div>
        <input type="hidden" id="empEditIndex" value="-1">
        <button type="button" id="btnGuardarEmpresa" class="btn-main">Guardar Empresa</button>
      </form>
    </div>
    <div id="contenedorListaEmpresas"><ul id="listaEmpresas"></ul></div>
  </section>

  <section id="pantallaClientes" class="pantalla">
    <div class="cabecera-seccion">
      <h2>Clientes</h2>
      <button id="btnNuevoCliente" class="btn-main-short">+ Añadir</button>
    </div>
    <div id="contenedorFormCliente" style="display: none;">
      <form id="formcliente" class="formulario-card">
        <div class="form-header">
          <h3 id="tituloFormCliente">Nuevo Cliente</h3>
          <button type="button" class="btn-cancelar" onclick="alternarVista('Cliente', false)">X</button>
        </div>
        <div class="grid-form">
          <input type="text" id="cliNombre" placeholder="Nombre">
          <input type="text" id="cliApellidos" placeholder="Apellidos">
          <input type="text" id="cliCIF" placeholder="CIF/NIF">
          <input type="text" id="cliCalle" placeholder="Calle">
          <input type="text" id="cliNumero" placeholder="Número">
          <input type="text" id="cliPuerta" placeholder="Puerta/Piso">
          <input type="text" id="cliCP" placeholder="CP">
          <input type="text" id="cliLocalidad" placeholder="Localidad">
          <input type="text" id="cliProvincia" placeholder="Provincia">
          <input type="text" id="cliTelefono" placeholder="Teléfono">
          <input type="email" id="cliEmail" placeholder="Email">
        </div>
        <input type="hidden" id="cliEditIndex" value="-1">
        <button type="button" id="btnGuardarCliente" class="btn-main">Guardar Cliente</button>
      </form>
    </div>
    <div id="contenedorListaClientes"><ul id="listaClientes"></ul></div>
  </section>

  <section id="pantallaPresupuestos" class="pantalla">
    <div class="cabecera-seccion">
      <h2>Presupuestos</h2>
      <button id="btnAbrirFormPresupuesto" class="btn-main-short">+ Nuevo</button>
    </div>

    <div id="contenedorFormPresupuesto" style="display: none;">
      <div class="formulario-card">
        <div class="form-header">
          <h3 id="tituloFormPresupuesto">Gestión de Presupuesto</h3>
          <button type="button" class="btn-cancelar" id="btnCerrarPresupuesto">Cerrar</button>
        </div>
        <div class="grid-form">
          <input type="text" id="preNombre" placeholder="Nombre del Presupuesto (ej: Reforma Cocina)">
          <select id="preEmpresaSeleccionada"></select>
          <select id="preClienteSeleccionado"></select>
        </div>

        <div id="zonaConceptos" class="zona-subform">
          <h4>Añadir Concepto</h4>
          <div class="grid-form">
            <input type="text" id="conDescripcion" placeholder="Descripción">
            <input type="number" id="conCantidad" placeholder="Cant." step="0.01">
            <input type="number" id="conPrecio" placeholder="Precio U." step="0.01">
            <input type="number" id="conIVA" placeholder="IVA %">
          </div>
          <button type="button" id="btnAgregarConcepto" class="btn-secondary">Añadir Concepto</button>
        </div>

        <table class="tabla-dinamica">
          <thead><tr><th>Descripción</th><th>Total</th><th>Acción</th></tr></thead>
          <tbody id="bodyConceptosTemporal"></tbody>
        </table>

        <button type="button" id="btnGuardarPresupuestoFinal" class="btn-main">Guardar Todo el Presupuesto</button>
      </div>
    </div>
    <div id="contenedorListaPresupuestos"><ul id="listaPresupuestos"></ul></div>
  </section>

  <section id="pantallaFacturas" class="pantalla">
    <h2>Facturas</h2>
    <ul id="listaFacturas"></ul>
  </section>

  <section id="pantallaAjustes" class="pantalla">
    <h2>Configuración</h2>
    <div class="formulario-card">
      <label>Color: <input type="color" id="ajusteColor"></label>
      <label>IVA Defecto: <input type="number" id="ajusteIVA"></label>
      <button id="btnGuardarAjustes" class="btn-main">Guardar Ajustes</button>
    </div>
  </section>

  <div id="modalOpcionesFactura" class="modal">
    <div class="modal-content">
      <h3>Opciones de Emisión</h3>
      <div class="grid-form">
        <label>Método de Pago:
          <select id="facMetodoPago">
            <option value="transferencia">Transferencia</option>
            <option value="bizum">Bizum</option>
            <option value="efectivo">Efectivo</option>
            <option value="tarjeta">Tarjeta</option>
          </select>
        </label>
        <input type="text" id="facPlazo" placeholder="Plazo de pago (ej: 30 días)">
      </div>
      <div class="modal-footer">
        <button id="btnCancelarEmision" class="btn-cancelar">Cancelar</button>
        <button id="btnConfirmarEmision" class="btn-confirm-modal">Emitir Factura</button>
      </div>
    </div>
  </div>

  <div id="modalPreview" class="modal">
    <div class="modal-content">
      <div class="modal-header"><span class="close-modal">&times;</span><h3>Vista Previa</h3></div>
      <div id="previewContenido"></div>
      <div class="modal-footer">
        <button id="btnConfirmarPDF" class="btn-confirm-modal">Descargar PDF</button>
      </div>
    </div>
  </div>
</main>

<script src="app.js"></script>
</body>
</html>
